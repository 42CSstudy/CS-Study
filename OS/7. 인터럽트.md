# 인터럽트
인터럽트는 운영 체제(OS)가 현재 실행 중인 작업을 잠시 중단하고, 급하거나 특별한 이벤트를 처리할 수 있게 해주는 메커니즘이다. 이 이벤트는 하드웨어 또는 소프트웨어로부터 발생할 수 있다.
## 인터럽트 개념
순차적 프로그래밍 에서는 버튼이 눌렸는지, 안눌렸는지 주기적으로 직접 확인 → 비효율적이다.

버튼이 눌리면 시스템에 알려줌 → event driven 방식

### 인터럽트의 용도

입출력 용도 뿐만 아니라, Ctrl + c로 프로세스 멈추는 것도 인터럽트
어떤 프로세스가 다른 프로세스의 메모리 영역에 침범 하는 것도 인터럽트

### 하드웨어 인터럽트
하드웨어 인터럽트는 주로 외부 장치(예: 키보드, 마우스, 네트워크 카드 등)로부터 발생합니다. 예를 들어, 사용자가 키보드를 누를 때마다 키보드는 인터럽트 신호를 CPU에 보내어 해당 키 누름 이벤트를 처리하도록 요청합니다. CPU는 이 신호를 받으면 현재 실행 중인 작업을 잠시 중단하고, 키보드 입력 처리와 같은 인터럽트 서비스 루틴(ISR)을 실행합니다. 처리가 끝나면, CPU는 중단됐던 작업을 계속해서 진행합니다.

### 소프트웨어 인터럽트
소프트웨어 인터럽트는 프로그램 내부에서 발생하며, 주로 운영 체제의 서비스를 요청할 때 사용됩니다. 예를 들어, 프로그램이 파일을 읽거나 쓰기 위해 디스크 입출력을 요청할 때, 해당 요청은 소프트웨어 인터럽트를 통해 처리됩니다. 이 경우, 인터럽트는 시스템 콜(system call)을 통해 발생하며, 운영 체제는 해당 요청을 처리한 후 프로그램으로 제어를 반환합니다.

## 동기적 인터럽트, 비동기적 인터럽트
### 동기적 인터럽트 : 실행 중인 명령어로 인해 발생 하는 인터럽트
예시

프로그램 상의 문제 때문에 일어나는 인터럽트 ( 다른 프로세스의 메모리에 접근 … )

입출력 장치의 조작

수를 0으로 나눔

### 비동기적 인터럽트 : 실행 중인 명령어와 무관하게 발생하는 인터럽트, 하드웨어와 관련된 것이 다수

예시

하드디스크 읽기 오류

메모리 불량



## 인터럽트 처리과정

### 1. 인터럽트 발생

하드웨어 인터럽트: 외부 장치(예: 키보드, 마우스, 네트워크 인터페이스)에서 이벤트가 발생하면, 장치는 인터럽트 요청(IRQ) 신호를 CPU에 전송합니다.

소프트웨어 인터럽트: 프로그램이 실행 중에 특정 조건을 만족하거나 시스템 콜을 통해 의도적으로 생성됩니다.

### 2. 인터럽트 인식
CPU는 현재 실행 중인 명령어를 완료한 직후에 인터럽트 요청을 검사합니다. 만약 인터럽트가 대기 중이라면, CPU는 인터럽트를 인식하고 처리를 위한 준비를 시작합니다.

### 3. 인터럽트 처리 준비

현재 상태 저장: CPU는 인터럽트를 처리하기 전에 현재 실행 중인 프로세스의 상태(예: 레지스터 값, 프로그램 카운터)를 저장합니다. 이는 나중에 원래 작업으로 복귀할 때 이전 상태로 돌아갈 수 있게 합니다.

인터럽트 벡터: CPU는 인터럽트 벡터 테이블을 사용하여 해당 인터럽트를 처리할 인터럽트 서비스 루틴(ISR)의 주소를 찾습니다. 인터럽트 벡터 테이블은 각 인터럽트 유형에 대한 ISR 주소를 매핑한 데이터 구조입니다.

### 4. 인터럽트 서비스 루틴(ISR) 실행

CPU는 인터럽트 벡터 테이블에서 찾은 ISR의 주소로 점프하여 인터럽트 처리 코드를 실행합니다. ISR은 인터럽트의 원인이 된 이벤트를 처리하며, 필요한 경우 운영 체제의 다른 부분이나 드라이버와 상호작용할 수 있습니다.

### 5. 인터럽트 처리 완료

ISR 실행이 완료되면, 인터럽트 처리에 대한 마무리 작업이 수행됩니다. 이 단계에서는 필요한 경우 추가적인 정리 작업을 진행하고, 인터럽트가 성공적으로 처리되었음을 시스템에 알립니다.

### 6. 원래 작업으로 복귀

CPU는 인터럽트 처리 전에 저장했던 프로세스의 상태를 복원합니다. 이후 프로그램 카운터를 원래의 위치로 설정하여 인터럽트 발생 전에 실행 중이던 프로세스의 실행을 재개합니다.

## 인터럽트와 이중 모드
프로세스 → 커널 프로세스 / 사용자 프로세스로 나눌 수 있음

커널 프로세스가 실행되는 상태 → 커널 모드

사용자 프로세스가 실행되는 상태 → 사용자 모드

### 이중 모드 ( dual mode )

사용자 프로세스에서, 하드디스크 입출력, 프로세스 생성 등 커널의 기능을 사용하기 위해서 사용자모드 → 커널모드로 전환 하며 일 처리를 하는 모드

운영체제가 자원을 보호하기 위해 사용하는 기법

커널은 시스템 호출을 통해서만 자원에 접근하도록 허용

사용자 프로세스가 커널 모드에서 실행되지 못하도록 막음

이러한 시스템 호출 위해 API를 제공

이렇게 사용자가 커널 모드로 진입 하는 경우는, 시스템 호출을 사용 한 경우, 인터럽트를 발생 시킨 경우로 두가지 경우가 있음